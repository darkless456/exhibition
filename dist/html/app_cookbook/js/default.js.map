{"version":3,"sources":["default.js"],"names":["$","document","on","bindEvent","retrieval","history","back","hot","prefs","isAjax","local","window","localStorage","session","sessionStorage","recipelist","recipeinfo","favlist","process","obj","fn","extend","getVal","this","val","getRecipeList","button","mobile","loading","keyword","getJSON","word","data","code","html","msg","empty","clear","datalist","newslist","each","index","value","oLi","appendTo","oA","prop","attr","data-no","data-transition","addClass","save2Storage","call","listview","getRecipeDetail","src","arr","push","setItem","join","para","material","food_name","seasoning","tutorial","tips","feature","onoff","id","res","dataTmp","split","console","log","json","tmp","subsection","_arr","e","showFav","showfav","save2SQL"],"mappings":"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","file":"default.js","sourcesContent":["/*\n* @Author: darkless\n* @Date:   2016-03-30 17:52:09\n* @Last Modified by:   Kevin\n* @Last Modified time: 2016-04-07 21:28:56\n*/\n\n\n\n$(document).on('pageinit', '#index', function(){\n    bindEvent.retrieval();\n})\n\n$(document).on('pageinit', '#detail', function(){\n    $('#infoTitle').on('tap', function(){\n        history.back(-1);\n    })\n})\n\n$(document).on('pageinit', '#fav', function(){\n    bindEvent.hot();\n})\n\n//参数\nvar prefs = {\n    isAjax: false,\n    local: window.localStorage,\n    session: window.sessionStorage,\n    recipelist: $('#book'),\n    recipeinfo: $('#info'),\n    favlist: $('#favlist')\n};\n\n//处理函数\nvar process = (function(){\n    var obj = {};\n\n    $.fn.extend({\n        getVal: function(){\n            return this.val();\n        }\n    })\n\n    obj.getRecipeList = function(){\n        $(this).button('option','disabled',true);\n        $.mobile.loading('show');\n        var keyword = $('#recipe').getVal();\n        $.getJSON('http://api.huceo.com/txapi/caipu/?key=721d38ca8ac658cd2cac2ae4b0131977&num=10', {'word':keyword}, function(data){\n            if(data.code != '200'){\n                prefs.recipelist.html(data.msg);\n                return;\n            }\n            prefs.recipelist.empty();\n            prefs.session.clear();\n            var datalist = data.newslist;\n            $.each(datalist, function(index, value){\n                var oLi = $('<li>').appendTo(prefs.recipelist);\n                var oA = $('<a>').prop('href', '#detail').attr({'data-no': datalist[index]['id'],\n                    'data-transition': 'slide'}).appendTo(oLi);\n                $('<h2>').html(datalist[index]['cp_name']).appendTo(oA);\n                $('<p>').html(datalist[index]['texing']).appendTo(oA);\n                $('<p>').html(datalist[index]['type_name']).addClass('ui-li-aside').appendTo(oA);\n\n                process.save2Storage.call(value['id'],value);\n            })\n            prefs.recipelist.listview(\"refresh\");\n            $('#book>li a').on('tap', function(){\n                process.getRecipeDetail.call(this,1);\n            });\n        })\n        $(this).button('option', 'disabled', false);\n        $.mobile.loading('hide');\n\n    }\n    obj.save2Storage = function(src){\n        var arr = [];\n        $.each(src, function(index, value){\n            arr.push(index+':'+value);\n        })\n        prefs.session.setItem(this, arr.join('@'));\n    }\n\n    obj.getRecipeDetail = function(para){\n        var onoff = para;\n        var id = $(this).attr('data-no');\n        var res = prefs.session[id];\n        var dataTmp = res.split('@');\n        var material,food_name,seasoning,tutorial,tips,feature;\n        if(onoff == 1){\n            console.log('true');\n            var json = {};\n            $.each(dataTmp, function(index, value){\n                var tmp = value.split(':');\n                json[tmp[0]] = tmp[1];\n            })\n            food_name = json['cp_name'];\n            material = json['yuanliao'];\n            seasoning = json['tiaoliao'];\n            tutorial = json['zuofa'];\n            tips = json['tishi'];\n            feature = json['texing'];\n        } else{\n            console.log('false');\n            food_name = dataTmp[2].split(':')[1];\n            material = dataTmp[4].split(':')[1];\n            seasoning = dataTmp[5].split(':')[1];\n            tutorial = dataTmp[6].split(':')[1];\n            tips = dataTmp[7].split(':')[1];\n            feature = dataTmp[8].split(':')[1];\n        }\n        prefs.recipeinfo.empty();\n        $('#infoTitle').html(food_name);\n        $('<li>').html('<h2>食材用料:</h2>'+process.subsection(material)).appendTo(prefs.recipeinfo);\n        $('<li>').html('<h2>食材调味:</h2>'+process.subsection(seasoning)).appendTo(prefs.recipeinfo);\n        $('<li>').html('<h2>食谱做法:</h2>'+process.subsection(tutorial)).appendTo(prefs.recipeinfo);\n        $('<li>').html('<h2>小贴士:</h2><p>'+tips+'</p>').appendTo(prefs.recipeinfo);\n        $('<li>').html('<h2>菜肴特色:</h2><p>'+feature+'</p>').appendTo(prefs.recipeinfo);\n        // $.mobile.changePage('#detail');\n    }\n\n    obj.subsection = function(src){\n        var _arr = [];\n        var tmp = src.split('；');\n        $.each(tmp, function(index, value){\n            _arr.push('<p>'+value+'</p>');\n        })\n        return _arr.join('');\n    }\n\n    return obj;\n}());\n\n//绑定事件函数\nvar bindEvent = (function(){\n    var obj = {};\n    obj.retrieval = function(){\n        $('#searchBtn').on('tap', function(e){\n            process.getRecipeList.call(this);\n        });\n    }\n\n    obj.hot = function(){\n        process.showFav();\n    }\n\n\n    return obj;\n})();\n\nvar process = (function(obj){\n    obj.showFav = function(){\n        $.mobile.loading('show');\n        $.getJSON('./script/toSQL.php', {'showfav': '1'}, function(data){\n            prefs.favlist.empty();\n            prefs.session.clear();\n            var datalist = data;\n            $.each(datalist, function(index, value){\n                var oLi = $('<li>').appendTo(prefs.favlist);\n                var oA = $('<a>').prop('href', '#detail').attr({'data-no': datalist[index]['rid'],'data-transition': 'slide'}).appendTo(oLi);\n                $('<h2>').html(datalist[index]['name']).appendTo(oA);\n                $('<p>').html(datalist[index]['feature']).appendTo(oA);\n                $('<p>').html(datalist[index]['classify']).addClass('ui-li-aside').appendTo(oA);\n\n                process.save2Storage.call(value['rid'],value);\n            })\n\n            prefs.favlist.listview(\"refresh\");\n            $.mobile.loading('hide');\n            $('#favlist>li a').on('tap', function(e){\n                process.getRecipeDetail.call(this,0);\n            });\n        })\n    }\n\n    obj.save2SQL = function(){\n\n    }\n\n    return obj;\n}(process));"],"sourceRoot":"/source/"}